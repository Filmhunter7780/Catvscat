<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Kia Rio 2014 — 3D блок предохранителей (салон)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#0f172a;
  color:#e5e7eb;
  font-family:system-ui;
}
#ui{
  position:absolute;
  top:16px;
  left:16px;
  z-index:10;
  background:#020617e6;
  padding:14px 16px;
  border-radius:12px;
  width:340px;
}
h2{margin:0 0 8px 0;font-size:18px}
.label{font-size:13px;color:#94a3b8}
.value{margin-bottom:10px}
</style>
</head>

<body>

<div id="ui">
  <h2>Kia Rio 2014</h2>
  <div class="label">Кликните по предохранителю</div>
</div>

<!-- ❗ СТРОГО r128 — НИЧЕГО ДРУГОГО -->
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

<script>
/* ===== ДАННЫЕ ПРЕДОХРАНИТЕЛЕЙ ===== */
const fuses = [
 {id:1,amps:15,desc:'Обогрев зоны покоя щеток'},
 {id:2,amps:15,desc:'Доп. розетка'},
 {id:3,amps:15,desc:'Прикуриватель'},
 {id:4,amps:10,desc:'Аудио, BCM, ключ'},
 {id:5,amps:10,desc:'Airbag OFF'},
 {id:6,amps:10,desc:'SRS'},
 {id:7,amps:10,desc:'Аварийка'},
 {id:8,amps:null,desc:'Резерв'},
 {id:9,amps:null,desc:'Резерв'},
 {id:10,amps:15,desc:'Задний дворник'},
 {id:11,amps:null,desc:'Резерв'},
 {id:12,amps:10,desc:'Задний ПТФ'},
 {id:13,amps:10,desc:'Передние ПТФ'},
 {id:14,amps:10,desc:'Авто-свет'},
 {id:15,amps:15,desc:'Стоп-сигналы'},
 {id:16,amps:10,desc:'Приборка, BCM'},
 {id:17,amps:10,desc:'Стопы, OBD'},
 {id:18,amps:10,desc:'ABS / ESP'},
 {id:19,amps:10,desc:'Задний ход'},
 {id:20,amps:10,desc:'ЭБУ двигателя'},
 {id:21,amps:10,desc:'Левая фара'},
 {id:22,amps:10,desc:'ДХО'},
 {id:23,amps:15,desc:'Аварийка'},
 {id:24,amps:25,desc:'Электронный ключ'},
 {id:25,amps:null,desc:'Резерв'},
 {id:26,amps:10,desc:'Start / Stop'},
 {id:27,amps:15,desc:'Скорость / АКП'},
 {id:28,amps:15,desc:'Катушки'},
 {id:29,amps:10,desc:'Фары, климат'},
 {id:30,amps:25,desc:'Дворники'},
 {id:31,amps:20,desc:'Замки дверей'},
 {id:32,amps:25,desc:'Стеклоподъемники'},
 {id:33,amps:15,desc:'Обогрев сидений'},
 {id:34,amps:null,desc:'Резерв'},
 {id:35,amps:10,desc:'Салон, багажник'},
 {id:36,amps:20,desc:'Аудио'},
 {id:37,amps:10,desc:'Левый задний фонарь'},
 {id:38,amps:10,desc:'Правый задний фонарь'},
 {id:39,amps:10,desc:'Замок зажигания'},
 {id:40,amps:10,desc:'Правая фара'},
 {id:41,amps:25,desc:'Левые стекла'},
 {id:42,amps:25,desc:'Правые стекла'},
 {id:43,amps:10,desc:'Обогрев зеркал'},
 {id:44,amps:10,desc:'Кондиционер'},
 {id:45,amps:null,desc:'Резерв'}
];

/* ===== СЦЕНА ===== */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x020617);

const camera = new THREE.PerspectiveCamera(45, innerWidth/innerHeight, 0.1, 100);
camera.position.set(0,7,11);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

/* ===== СВЕТ ===== */
scene.add(new THREE.AmbientLight(0xffffff,0.7));
const dir = new THREE.DirectionalLight(0xffffff,0.8);
dir.position.set(5,10,5);
scene.add(dir);

/* ===== ОСНОВАНИЕ ===== */
scene.add(new THREE.Mesh(
  new THREE.BoxGeometry(10,0.6,6),
  new THREE.MeshStandardMaterial({color:0x1e293b})
));

/* ===== РАСПОЛОЖЕНИЕ КАК В РЕАЛЬНОМ БЛОКЕ ===== */
const layout = [
 {id:1,x:-4.4,z:2.4},{id:2,x:-3.5,z:2.4},{id:3,x:-2.6,z:2.4},{id:4,x:-1.7,z:2.4},
 {id:5,x:-0.8,z:2.4},{id:6,x:0.1,z:2.4},{id:7,x:1.0,z:2.4},{id:8,x:1.9,z:2.4},
 {id:9,x:2.8,z:2.4},{id:10,x:3.7,z:2.4},{id:11,x:4.6,z:2.4},

 {id:12,x:-4.2,z:1.4},{id:13,x:-3.3,z:1.4},{id:14,x:-2.4,z:1.4},{id:15,x:-1.5,z:1.4},
 {id:16,x:-0.6,z:1.4},{id:17,x:0.3,z:1.4},{id:18,x:1.2,z:1.4},{id:19,x:2.1,z:1.4},
 {id:20,x:3.0,z:1.4},{id:21,x:3.9,z:1.4},{id:22,x:4.8,z:1.4},

 {id:23,x:-4.0,z:0.4},{id:24,x:-3.1,z:0.4},{id:25,x:-2.2,z:0.4},{id:26,x:-1.3,z:0.4},
 {id:27,x:1.5,z:0.4},{id:28,x:2.4,z:0.4},{id:29,x:3.3,z:0.4},{id:30,x:4.2,z:0.4},

 {id:31,x:-4.0,z:-0.6},{id:32,x:-3.1,z:-0.6},{id:33,x:-2.2,z:-0.6},{id:34,x:-1.3,z:-0.6},
 {id:35,x:-0.2,z:-0.2},{id:36,x:0.3,z:-0.2},
 {id:37,x:1.6,z:-0.6},{id:38,x:2.5,z:-0.6},{id:39,x:3.4,z:-0.6},{id:40,x:4.3,z:-0.6},

 {id:41,x:-3.5,z:-1.6},{id:42,x:-2.6,z:-1.6},{id:43,x:-1.7,z:-1.6},
 {id:44,x:3.3,z:-1.6},{id:45,x:4.2,z:-1.6}
];

const fuseMeshes = [];
layout.forEach(p=>{
  const f = fuses.find(x=>x.id===p.id);
  const color =
    f.amps===10?0x991b1b:
    f.amps===15?0x1e40af:
    f.amps===20?0xfacc15:
    f.amps===25?0xe5e7eb:
    0x374151;

  const m = new THREE.Mesh(
    new THREE.BoxGeometry(0.6,1.2,0.6),
    new THREE.MeshStandardMaterial({color,transparent:true,opacity:f.amps?1:0.4})
  );
  m.position.set(p.x,1,p.z);
  m.userData = f;
  scene.add(m);
  fuseMeshes.push(m);
});

/* ===== КЛИКИ ===== */
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
const ui = document.getElementById('ui');
let active = null;

window.addEventListener('click',e=>{
  mouse.x = (e.clientX/innerWidth)*2-1;
  mouse.y = -(e.clientY/innerHeight)*2+1;
  raycaster.setFromCamera(mouse,camera);
  const hit = raycaster.intersectObjects(fuseMeshes);
  if(hit.length){
    if(active) active.material.emissive.set(0x000000);
    active = hit[0].object;
    active.material.emissive = new THREE.Color(0x38bdf8);
    const f = active.userData;
    ui.innerHTML = `<h2>Предохранитель №${f.id}</h2>
      <div class='label'>Номинал</div><div class='value'>${f.amps?f.amps+' A':'Резерв'}</div>
      <div class='label'>Назначение</div><div class='value'>${f.desc}</div>`;
  }
});

/* ===== ЦИКЛ ===== */
function animate(){
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene,camera);
}
animate();

window.addEventListener('resize',()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});
</script>

</body>
</html>
